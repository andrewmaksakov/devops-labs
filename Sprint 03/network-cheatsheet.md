# Network Cheatsheet — 10 команд для диагностики сети

## 1. Мой IP и интерфейсы
```bash
ip addr
```
Показывает все сетевые интерфейсы и их IP. Первое что проверяешь — "а у меня вообще IP есть?"

## 2. Кто слушает порты
```bash
ss -tlnp
```
TCP + Listening + Numeric + Process. Сервис не отвечает? Проверь, слушает ли он вообще нужный порт.

## 3. DNS-резолвинг
```bash
dig +short example.com
```
Возвращает IP по имени. Если пусто — DNS не работает, дальше можно не проверять.

## 4. DNS подробно (с TTL и сервером)
```bash
dig example.com
```
Полный ответ: IP, TTL, какой DNS-сервер ответил, время ответа.

## 5. HTTP-запрос с заголовками
```bash
curl -v http://localhost
```
Verbose — показывает весь диалог: запрос, заголовки ответа, тело. Главный инструмент отладки HTTP.

## 6. Только код ответа
```bash
curl -o /dev/null -s -w "%{http_code}\n" http://localhost
```
Быстрая проверка: 200 = ок, 502 = backend упал, 000 = вообще не подключился.

## 7. Проверить сертификат
```bash
echo | openssl s_client -connect example.com:443 2>/dev/null | openssl x509 -dates -noout
```
Показывает срок действия сертификата. Истёк — сайт не откроется.

## 8. Проверить доступность хоста
```bash
ping -c 3 example.com
```
Базовая проверка "машина жива?". Если не пингуется — проблема на уровне сети/фаервола.

## 9. Маршрут до хоста
```bash
traceroute example.com
```
Показывает через какие узлы идёт пакет. Видно где именно "застревает" трафик.

## 10. Перехват трафика
```bash
sudo tcpdump -i any port 80 -n
```
Тяжёлая артиллерия. Показывает каждый пакет. Используй когда всё остальное не помогло.

---

## Быстрая диагностика "сайт не работает"

```
1. ping example.com          → хост жив?
2. dig +short example.com    → DNS резолвится?
3. curl -v http://example.com → HTTP отвечает? Какой код?
4. ss -tlnp                  → сервис слушает порт?
5. sudo nginx -t             → конфиг валидный?
6. journalctl -u nginx -n 20 → что в логах?
```
